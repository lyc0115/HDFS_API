package com.lyc.hdfs;



import java.io.IOException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Map;

/**
 * @author lyc
 * @create 2020--11--01 17:06
 */
public class HdfsApiTest {
    public static void main(String[] args) throws IOException {
//        删除文件
//        String path = "/input/file1.txt";
//        boolean flag = HdfsUtils.delete(path);
//        System.out.println(flag ? "删除成功" : "删除失败");
//        HdfsUtils.close();
//
//        删除目录
//        String path = "/input";
//        boolean flag = HdfsUtils.deleteFiles(path);
//        System.out.println(flag ? "删除成功" : "删除失败");
//        HdfsUtils.close();
//
//        上传文件
//        String sourcePath = "E:/output/_SUCCES";
//        String targetPath = "/";
//        boolean flag = HdfsUtils.uploadFile(sourcePath, targetPath);
//        System.out.println(flag ? "上传成功" : "上传失败");
//        HdfsUtils.close();
//
//        创建文件
//        String context = "hello hadoop @Chinasofti\naafaflaffafafa";
//        String path = "/test.txt";
//        boolean flag = HdfsUtils.createFile(context, path);
//        System.out.println(flag ? "创建文件成功" : "创建文件失败");
//        HdfsUtils.close();
//
//        创建文件夹
//        String path = "/testDir";
//        boolean flag = HdfsUtils.createDir(path);
//        System.out.println(flag ? "创建文件夹成功" : "创建文件夹失败");
//        HdfsUtils.close();
//
//        文件重命名
//        String sourceName = "/test.txt";
//        String targetName = "/test1.txt";
//        boolean flag = HdfsUtils.fileRename(sourceName, targetName);
//        System.out.println(flag ? "命名成功" : "命名失败");
//        HdfsUtils.close();
//
//        判断文件是否存在
//        String path = "/test1.txt";
//        boolean flag = HdfsUtils.isFileExsits(path);
//        System.out.println(flag ? "文件存在" : "文件不存在");
//        HdfsUtils.close();
//
//        获取文件最后修改时间
//        String path = "/test1.txt";
//        long fileLastModified = HdfsUtils.fileLastModified(path);
//        System.out.println(fileLastModified);
//        HdfsUtils.close();
//
//        获取文件存储位置
//        String path = "/test1.txt";
//        HashMap<String, ArrayList<String>> map = HdfsUtils.fileLocation(path);
//        for (Map.Entry<String, ArrayList<String>> listEntry : map.entrySet()) {
//            System.out.println(listEntry.getKey() + ":" + listEntry.getValue());
//        }
//        HdfsUtils.close();
//
//        获取文件节点信息
//        HashMap<String, String> map = HdfsUtils.nodeList();
//        for (Map.Entry<String, String> entry : map.entrySet()) {
//            System.out.println(entry.getKey() + ":" + entry.getValue());
//        }
//        HdfsUtils.close();
//
//        读取文件
//        String path = "/file1.txt";
//        String filePath = "E:/file.txt";
//        boolean flag = HdfsUtils.readFile(path, filePath);
//        System.out.println(flag ? "读取成功" : "读取失败");
//        HdfsUtils.close();


    }
}
